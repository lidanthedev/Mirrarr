<!-- Single provider results partial -->
{% if provider_results %}
<details class="group" open>
    <summary
        class="flex items-center justify-between p-3 bg-slate-700/50 hover:bg-slate-700 rounded-lg cursor-pointer transition-colors list-none">
        <div class="flex items-center gap-3">
            <svg class="h-4 w-4 text-slate-400 transition-transform group-open:rotate-90" fill="none"
                stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
            <span class="font-medium text-white">{{ provider_name }}</span>
            <span class="text-sm text-slate-400">{{ provider_results|length }} option(s)</span>
        </div>
    </summary>

    <div class="mt-2 ml-7 space-y-1">
        {% for result in provider_results %}
        <button
            hx-get="/download/queue?url={{ result.download_url | urlencode }}&quality={{ result.quality | urlencode }}&source={{ result.source_site | urlencode }}&media_type={{ media_type }}&tmdb_id={{ tmdb_id }}&season={{ season }}&episode={{ episode }}"
            hx-target="#toast-container" hx-swap="innerHTML" {% if media_type=='movie' %}
            hx-on::after-request="document.getElementById('provider-modal').remove()" {% else %}
            hx-on::after-request="htmx.ajax('GET', '/series/{{ tmdb_id }}', '#modal-container')" {% endif %}
            class="flex items-center justify-between w-full p-3 bg-slate-800/50 hover:bg-slate-800 rounded-lg transition-colors group/item text-left">
            <div class="flex items-center gap-3">
                <div class="p-2 bg-slate-600 rounded-lg group-hover/item:bg-primary-600 transition-colors">
                    <svg class="h-4 w-4 text-slate-300 group-hover/item:text-white transition-colors" fill="none"
                        stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                    </svg>
                </div>
                <span class="font-medium text-white">{{ result.quality }}</span>
            </div>
            <span class="text-sm font-medium text-slate-300">
                {% if result.size_mb >= 1024 %}
                {{ "%.1f"|format(result.size_mb / 1024) }} GB
                {% else %}
                {{ "%.0f"|format(result.size_mb) }} MB
                {% endif %}
            </span>
        </button>
        {% endfor %}
    </div>
</details>
{% else %}
<!-- Provider returned no results -->
<details class="group">
    <summary
        class="flex items-center justify-between p-3 bg-slate-700/30 rounded-lg cursor-pointer list-none opacity-60">
        <div class="flex items-center gap-3">
            <svg class="h-4 w-4 text-slate-500 transition-transform group-open:rotate-90" fill="none"
                stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
            <span class="font-medium text-slate-400">{{ provider_name }}</span>
            <span class="text-sm text-slate-500">No results</span>
        </div>
    </summary>
</details>
{% endif %}